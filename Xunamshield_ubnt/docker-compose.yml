version: '3.8'

services:
  # Servicio para tu Aplicaci√≥n Web (PHP + Apache)
  xunam-app:
    build: .
    container_name: xunam_web_container
    ports:
      - "8080:80"
    volumes:
      - .:/var/www/html
    environment:
      - DB_HOST=192.168.158.10 # IP de tu Ubuntu/Host para conectar a Postgres local
    restart: always

  # Servicio para Metabase (Dashboard de Inteligencia)
  metabase:
    image: metabase/metabase:latest
    container_name: xunam_metabase
    ports:
      - "3000:3000"
    environment:
      - MB_DB_TYPE=postgres
      - MB_DB_DBNAME=xunam_db
      - MB_DB_PORT=5432
      - MB_DB_USER=xunam_alien
      - MB_DB_PASS=Xunam3322
      - MB_DB_HOST=192.168.158.10
    restart: always